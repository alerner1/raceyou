<div class="d-flex w-100">
  <!-- 100% of width: row. start of first 50%: img. start of second 50%: name/category/points-->
  <div class="d-flex w-50">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS52y5aInsxSm31CvHOFHWujqUx_wWTS9iM6s7BAm21oEN_RiGoog" alt="" class="rounded mx-auto">
  </div>
  <div class="d-flex flex-column justify-content-end w-50">
    <% if flash[:success] %>
      <%= flash[:success] %>
    <% end %>
    <h1><%= @runner.name %></h1>
    <div class="d-flex flex-row">
    <p class="w-50">
      <span class="font-weight-bold">Level: <%= @runner.rank_category.name.capitalize %></span><br>
      Points: <%= @runner.points %>
    </p>
    <% if !@current_user.friends.include?(@runner) && @current_user != @runner %>
     <%= button_to "Add Friend", friendships_path, method: :post, params: { :friendship => {:friend_id => @runner.id } }, class: "btn btn-outline-success my-2 my-sm-0" %>
    <% end %>
    <% if @current_user.friends.include?(@runner) %>
     <%= button_to "Unfriend", friendship_path(@runner), method: :delete, params: { :friendship => {:friend_id => @runner.id}}, data: {confirm: "Are you sure you want to unfriend #{@runner.name}?"}, class: "btn btn-outline-success my-2 my-sm-0" %>
    <% end %>
    <% if @runner.id == @current_user.id %>
     <%= button_to "Edit Profile", edit_runner_path(@runner), method: :get, class: "btn btn-outline-success my-2 my-sm-0 mr-2" %>
     <%= button_to "Delete Account", runner_path(@runner), method: :delete, data: {confirm: "Are you sure you want to delete your account?"}, class: "btn btn-outline-success my-2 my-sm-0" %>
    <% end %>
    </div>
  </div>
</div>

<!-- 100% of width: row. first 1/2: info. second 1/2: races/friends tabs -->
<div class="d-flex w-100">
  <div class="d-flex w-50 px-5">
    <!-- info columns go here -->
    <div class="d-flex flex-column w-25">
      
    </div>
    <div class="d-flex flex-column w-50">
    <table class="table">
      <tr>
        <th scope="row">Username</th>
        <td><%= @runner.username %></td>
      </tr>
      <tr>
        <th scope="row">Email</th>
        <td><%= @runner.email %></td>
      </tr>
      <tr>
        <th scope="row">Age</th>
        <td><%= @runner.age %></td>
      </tr>
      <tr>
        <th scope="row">Gender</th>
        <td><%= @runner.gender %></td>
      </tr>
    </table>
    </div>
    <div class="d-flex flex-column w-25">
      
    </div>
  </div>
  <div class="d-flex flex-column">
    <div class="d-flex">
      <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="races-tab" data-toggle="tab" href="#races" role="tab" aria-controls="races" aria-selected="true">Races</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="friends-tab" data-toggle="tab" href="#friends" role="tab" aria-controls="friends" aria-selected="false">Friends</a>
        </li>
      </ul>
    </div>
    <div class="tab-content profile-tab" id="myTabContent">
      <div class="tab-pane fade show active" id="races" role="tabpanel" aria-labelledby="races">
        <% if @runner.races.length > 0 %>
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Length</th>
                <th scope="col">Expires</th>
                <th scope="col">Completed?</th>
                <th scope="col">Finish Time</th>
              </tr>
            </thead>
            <tbody>
              <% @runner.races.each do |race| %>
                <tr>
                  <td><%= link_to race.length, race_path(race) %></td>
                  <td><%= race.expiration_date.strftime("%m/%d/%Y") %></td>
                  <td><%= race.registrations.find_by(runner_id: @runner.id).is_completed? %></td>
                  <% if race.registrations.find_by(runner_id: @runner.id).completed == true %>
                    <td><%= race.registrations.find_by(runner_id: @runner.id).finish_time_mins %>:<%= race.registrations.find_by(runner_id: @runner.id).finish_time_secs %></td>
                  <% else %>
                    <td>N/A</td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <h5 class="mt-3">None yet!</h5>
        <% end %>
      </div>
      <div class="tab-pane fade" id="friends" role="tabpanel" aria-labelledby="friends"> 
        <% if @runner.friends.length > 0 %>
          <table class="table">
            <% @runner.friends.each do |friend| %>
              <tr>
                <td><%= link_to friend.name, runner_path(friend) %></td>
              </tr>
            <% end %>
          </table>
        <% else %>
          <h5 class="mt-3">None yet!</h5>
        <% end %>
      </div>
    </div>
  </div>
</div>