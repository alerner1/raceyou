
<h1>Race details:</h1>
<ul>
  <li>Type: <%= @race.race_type %></li>
  <li>Length: <%= @race.length %></li>
  <li>Elevation increase: <%= @race.elevation_increase %></li>
  <li>Elevation decrease: <%= @race.elevation_decrease %></li>
  <li>Expires: <%= @race.expiration_date %></li>
  <li>Created by: <%= @race.created_by %></li>
</ul>

<h1 class="text-center"><%= "TK owner's" %> Race</h1>
<div class="d-flex">
  <div class="d-flex flex-column w-50 pr-5 mr-5 mt-5">
    <h3 class="ml-5">Race details:</h3>
    <div class="d-flex flex-column mx-5">
      <div class="d-flex flex-row">
        <p class="font-weight-bold w-50">Type</p>
        <p><%= @race.race_type %></p>
      </div>
      <div class="d-flex flex-row">
        <p class="font-weight-bold w-50">Length</p>
        <p><%= @race.length %></p>
      </div>
      <div class="d-flex flex-row">
        <p class="font-weight-bold w-50">Elevation Increase</p>
        <p><%= @race.elevation_increase %> feet</p>
      </div>
      <div class="d-flex flex-row">
        <p class="font-weight-bold w-50">Elevation Decrease</p>
        <p><%= @race.elevation_decrease %> feet</p>
      </div>
      <div class="d-flex flex-row">
        <p class="font-weight-bold w-50">Expires</p>
        <p><%= @race.expiration_date.strftime("%m/%d/%Y") %></p>
      </div>
    </div>
  </div>
  <div class="d-flex flex-column w-50">
    <h3 class="text-center">Runners</h3>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Age</th>
          <th scope="col">Completed?</th>
          <th scope="col">Finish Time</th>
        </tr>
      </thead>
      <tbody>
        <% @race.runners.each do |runner| %>
          <tr>
            <td><%= runner.name %></td>
            <td><%= runner.age %></td>
            <td><%= runner.registrations.find_by(race_id: @race.id).completed %></td>
            <td><%= runner.registrations.find_by(race_id: @race.id).finish_time %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<% if @race.closed == false %>
<% if !@current_user.races.include?(@race) %>
  <%= button_to "Sign up for this race", registrations_path, method: :post, params: { :registration => {:race_id => @race.id, :runner_id => session[:runner_id] } }, class: "btn btn-secondary"%>
<% else %>
  <%= button_to "Back out of this race", registration_path(@current_user.registrations.find_by(race_id: @race.id)), method: :delete, data: {confirm: "Are you sure you want to back out of this race?"}, class: "btn btn-secondary" %>
<% end %>
<% end %>


<% if @race.closed == false %>
  <%= button_to "Close race", race_path(@race), method: :patch, params: { :race => { :closed => true } }, class: "btn btn-secondary"%>
<% else %>
  This race is closed. <br>
<% end %>

<%= button_to "Delete Race", race_path(@race), method: :delete, data: {confirm: "Are you sure you want to delete this race?"}, class: "btn btn-secondary" %>
<%# delete race button only for creator works!. Could be better, name has to be the same because of string data type%>
<% if @current_user.name == @race.created_by %>
  <%= button_to "Delete Race", race_path(@race), {method: :delete, data: {confirm: "Are you sure you want to delete this race?"}} %>
<% end %>

